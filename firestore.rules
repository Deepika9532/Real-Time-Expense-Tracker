rules_version = '2';
service cloud.firestore {
  // Allow users to read/write their own user data
  match /databases/{database}/documents/users/{userId} {
    allow read, write: if request.auth != null && request.auth.uid == userId;
  }

  // Allow users to read/write their own expenses
  match /databases/{database}/documents/users/{userId}/expenses/{document=**} {
    allow read, write: if request.auth != null && request.auth.uid == userId;
  }

  // Allow users to read/write their own budgets
  match /databases/{database}/documents/users/{userId}/budgets/{document=**} {
    allow read, write: if request.auth != null && request.auth.uid == userId;
  }

  // Allow users to read/write their own categories
  match /databases/{database}/documents/users/{userId}/categories/{document=**} {
    allow read, write: if request.auth != null && request.auth.uid == userId;
  }

  // Allow users to read/write their own analytics data
  match /databases/{database}/documents/users/{userId}/analytics/{document=**} {
    allow read, write: if request.auth != null && request.auth.uid == userId;
  }

  // Allow users to read/write their own profile settings
  match /databases/{database}/documents/users/{userId}/profile_settings/{document=**} {
    allow read, write: if request.auth != null && request.auth.uid == userId;
  }

  // Deny access to all other documents
  match /databases/{database}/documents/{document=**} {
    allow read, write: if false;
  }
}